@{
  Layout = "ProjectMaster.cshtml";
}

@section Projectcss{
<link href="/css/jquery-ui/jquery-ui.min.css" rel="stylesheet">
<style type="text/css">
<!--
.media:hover {background: lightblue;}
.media {padding: 6px; margin:0px;}
.panel-body {padding:0px;}
.progress {margin-bottom:0px;}

    .task-box {
        align-content:center;
        text-align:center;
    }

    .task-box-header {
        margin-right:0;
        margin-left:0;
        position: relative;
        width:100%;
        background-color: #92d050;
        border-color: #ddd;
        border-width: 1px;
        border-radius: 4px 4px 0 0;
        box-shadow: none;
        border-style: solid;
        padding: 4px;
        text-align:left;
    }

    .task-box-body {
        padding-bottom:5px;
        
        margin-top: -5px;
        margin-right: 1px;
        margin-left: 1px;
        color: #64584f;
        background: #fff;
        -webkit-border-bottom-left-radius: 4px;
        -webkit-border-bottom-right-radius: 4px;
        -moz-border-radius-bottomleft: 4px;
        -moz-border-radius-bottomright: 4px;
        border-bottom-left-radius: 4px;
        border-bottom-right-radius: 4px;
        text-shadow: 0 1px 0 #fff;
        -webkit-box-shadow: 0 1px 3px #9d9891;
        -moz-box-shadow: 0 1px 3px #9d9891;
        box-shadow: 0 1px 3px #9d9891;
        border: 1px solid #f9f9f8;
        behavior: url(PIE.htc);
        padding: 8px;

        text-align:left;
        word-wrap:break-word;
    }

    .task-box hr {
        margin: 0 5px 0 5px;
        padding: 0;
        border: 0;
        height: 1px;
        background: #b6b1a9;
        -webkit-box-shadow: 0 1px 0 #fff;
        -moz-box-shadow: 0 1px 0 #fff;
        box-shadow: 0 1px 0 #fff;
        behavior: url(PIE.htc);
    }

    .task-box-footer {
        text-align:right;
    }

    .task-list {
        list-style-type:none;
        padding:0;
    }

    .task-list-item {
        margin:0;
        padding:0;
        padding-bottom:5px;

    }

    #task-board {
        table-layout:fixed;
        min-height:450px;
        height:100%;
        background-color:lightyellow;
    }
    
    #task-board thead {
        text-align:center;
        background-color:#ffd77a;
    }

    #task-board td {
        border-left:1px solid #808080;
        border-right:1px solid #808080;
    }

    .task-board-column {
        border-left:1px solid #808080;
        border-right:1px solid #808080;
    }

-->
</style>
}

<table id="task-board" class="table">
    <thead>
        <tr><td>Backlog</td><td>Ready</td><td>In Progress</td><td>Done</td></tr>
    </thead>
    <tbody>
        <tr>
            <td id="backlog-column" class="task-board-column">
                <ul id="backlog-list" class="task-list">
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                </ul>
            </td>
            <td id="ready-column" class="task-board-column">
                <ul id="ready-list" class="task-list">
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                </ul>
            </td>
            <td id="in-progress-column" class="task-board-column">
                <ul id="in-progress-list" class="task-list">
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                </ul>
            </td>
            <td id="done-column" class="task-board-column">
                <ul id="done-list" class="task-list">
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                    <li class="task-list-item" value="61"><div class="task-box"><div class="task-box-header">61</div><hr><div class="task-box-body">タスクタイトル<hr><div class="task-box-footer">10pt</div></div></div></li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>

@*@Html.Partial("Sprint.cshtml", Model.Project)
<a class="btn btn-default pull-right" href="~/project/@Model.Project.Id/edit" >Edit</a>*@

@section ProjectJs{
<script src="~/js/jquery-ui.min.js"></script>
<script type="text/javascript">
  $(function () {

      $(document).ready(function () {
          // #div1をdrag可能に
          //$(".task-box").draggable();

          options = {
              revert: true,
              zIndex: 100,
              containment: $('#task-board tbody'),
              handle: '.task-box-header',
          };

          $(".task-list-item").draggable(options);

          $('#backlog-column').droppable({
              drop: function (event, ui) {
                  var item = ui.draggable.clone();
                  item[0].style.top = 0;
                  item[0].style.left = 0;
                  item[0].style.zIndex = 0;
                  $('#backlog-list').append(item[0]);
                  ui.draggable.remove();
                  $(".task-list-item").draggable(options);
                  //window.setTimeout(function () {
                  //    $('#one').swapWith($('#two'));
                  //    $("li").draggable(options);
                  //}, 600);
              }
          });

          $('#ready-column').droppable({
              drop: function (event, ui) {
                  var item = ui.draggable.clone();
                  item[0].style.top = 0;
                  item[0].style.left = 0;
                  item[0].style.zIndex = 0;
                  $('#ready-list').append(item[0]);
                  ui.draggable.remove();
                  $(".task-list-item").draggable(options);
              }
          });

          $('#in-progress-column').droppable({
              drop: function (event, ui) {
                  var item = ui.draggable.clone();
                  item[0].style.top = 0;
                  item[0].style.left = 0;
                  item[0].style.zIndex = 0;
                  $('#in-progress-list').append(item[0]);
                  ui.draggable.remove();
                  $(".task-list-item").draggable(options);
              }
          });

          $('#done-column').droppable({
              drop: function (event, ui) {
                  var item = ui.draggable.clone();
                  item[0].style.top = 0;
                  item[0].style.left = 0;
                  item[0].style.zIndex = 0;
                  $('#done-list').append(item[0]);
                  ui.draggable.remove();
                  $(".task-list-item").draggable(options);
              }
          });
      });

      jQuery.fn.swapWith = function (to) {
          return this.each(function () {
              var copy_to = $(to).clone();
              var copy_from = $(this).clone();
              $(to).replaceWith(copy_from);
              $(this).replaceWith(copy_to);
          });
      };

  });
</script>
}
